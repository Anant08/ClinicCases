$(document).ready(function(){$("#board_nav button").button({icons:{primary:"fff-icon-add"},text:!0}).click(function(t){if(t.preventDefault(),$("div.new_post").show().animate({width:"900",height:"500"}).attr("data-new","yes"),$.post("lib/php/data/board_process.php",{action:"new"},function(t){var e=$.parseJSON(t);e.error===!0?notify(e.message,!0):($("div.new_post").attr("data-id",e.post_id),new qq.FileUploader({element:$(".board_upload")[0],action:"lib/php/utilities/file_upload_board.php",params:{post_id:e.post_id},template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">Choose Files</div><ul class="qq-upload-list"></ul></div>'}))}),1>$("div.rte-zone").length)var e=$("div.new_post").find(".post_edit").rte({css:["lib/javascripts/lwrte/default2.css"],width:900,height:300,controls_rte:rte_toolbar});$('input[name="post_title"]').focusin(function(t){t.stopPropagation(),$(this).parent().unbind("click.sizePost"),"New Post Title"===$(this).val()&&$(this).val("").css({color:"black"})}),$('select[name="viewer_select[]"]').chosen(),$('select[name="post_color"]').change(function(){var t="rgba("+$(this).val()+",0.5)";$("div.rte-zone").css({"background-color":t})}),$(".board_new_item_menu_bottom button").first().click(function(t){t.preventDefault();var a=$('<div class="dialog-casenote-delete" title="Delete this Post?">Are you sure you don\'t want to save this post?</div>').dialog({autoOpen:!1,resizable:!1,modal:!0,buttons:{Yes:function(){var t=$("div.new_post").attr("data-id");$("div.new_post").hide(),$('form[name="new_post_form"]')[0].reset(),$('select[name="viewer_select[]"]').trigger("liszt:updated"),e[0].set_content(""),$("div.rte-zone").css({"background-color":"#FFF"}),$.post("lib/php/data/board_process.php",{action:"delete",item_id:t},function(t){var e=$.parseJSON(t);e.error===!0?notify(e.message,!0):notify(e.message)}),$(this).dialog("destroy")},No:function(){$(this).dialog("destroy")}}});$(a).dialog("open")}).next().click(function(t){t.preventDefault();var a=$("form").serializeArray(),o=$("div.new_post").attr("data-id");a.push({name:"id",value:o}),a.push({name:"action",value:"edit"}),a.push({name:"text",value:e[0].get_content()}),$.post("lib/php/data/board_process.php",a,function(t){var e=$.parseJSON(t);e.error===!0?notify(e.message,!0):(notify(e.message),$("#board_panel").load("lib/php/data/board_load.php"))})})}),$("#board_panel").load("lib/php/data/board_load.php"),$(".board_item").live("click.sizePost",function(){$(this).not(".new_post").animate({width:"400",height:"300"},function(){$(this).css({height:"auto","max-width":"400"}),$(".board_item").not(this).animate({width:"200",height:"200"})})}),$("a.attachment").live("click",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).attr("data-id");$(this).hasClass("pdf")?Object.create?($("#pdf-viewer").show(),$("#frme").attr("src","lib/javascripts/pdfjs/web/viewer.html?target=board&item_id="+e),$("#pdf-viewer").click(function(){$("#frme").attr("src",""),$(this).hide()}),$("body").bind("keyup.pdfViewer",function(t){27===t.keyCode&&($("#frme").attr("src",""),$("#pdf-viewer").hide())})):$.download("lib/php/data/board_process.php",{item_id:e,action:"download"}):$.download("lib/php/data/board_process.php",{item_id:e,action:"download"})}),$("a.board_item_delete").live("click",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).closest("div.board_item").attr("data-id"),a=$('<div class="dialog-casenote-delete" title="Delete this Post?">This post and any attachments will be permanently deleted.  Are you sure?</div>').dialog({autoOpen:!1,resizable:!1,modal:!0,buttons:{Yes:function(){$.post("lib/php/data/board_process.php",{action:"delete",item_id:e},function(t){var e=$.parseJSON(t);e.error===!0?notify(e.message,!0):(notify(e.message),$("#board_panel").load("lib/php/data/board_load.php"))}),$(this).dialog("destroy")},No:function(){$(this).dialog("destroy")}}});$(a).dialog("open")}),$("a.board_item_edit").live("click",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).closest("div.board_item"),a=$("div.new_post").clone(),o=e.attr("data-id");e.hide(),e.after(a),a.css({display:"inline-block",height:"500px",width:"900px"});var i=a.find(".post_edit").rte({css:["lib/javascripts/lwrte/default2.css"],width:900,height:300,controls_rte:rte_toolbar});new qq.FileUploader({element:a.find(".board_upload")[0],action:"lib/php/utilities/file_upload_board.php",params:{post_id:o},template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">Choose Files</div><ul class="qq-upload-list"></ul></div>'}),a.find("div.rte-zone").css({"background-color":e.css("background-color")}),a.find('select[name="post_color"]').change(function(){var t="rgba("+$(this).val()+",0.5)";a.find("div.rte-zone").css({"background-color":t})}),a.find('select[name="post_color"]').val(e.attr("data-color")),a.find('input[name="post_title"]').val(e.find("h3").text()).css({color:"black"}),a.find("div.new_post").attr("data-id",o),i[0].set_content(e.find("div.body_text").html()),a.find('select[name="viewer_select[]"]').chosen();var s=e.attr("data-viewers").split(",");a.find('select[name="viewer_select[]"]').val(s).trigger("liszt:updated");var d=e.find("div.attachment_container").html();d&&a.find("div.board_new_item_menu_bottom label").append(d+"<br />"),a.find("button").first().click(function(t){t.preventDefault(),a.remove(),e.show(),notify("Edit cancelled.")}).next().click(function(t){t.preventDefault();var e=$(this).closest("form").serializeArray();e.push({name:"id",value:o}),e.push({name:"action",value:"edit"}),e.push({name:"text",value:i[0].get_content()}),$.post("lib/php/data/board_process.php",e,function(t){var e=$.parseJSON(t);e.error===!0?notify(e.message,!0):(notify(e.message),$("#board_panel").load("lib/php/data/board_load.php"))})})}),$('input[name = "board_search"]').keyup(function(){$(this).next(".casenotes_search_clear").show().click(function(t){t.preventDefault(),$(this).prev().val(""),$("#board_panel").load("lib/php/data/board_load.php"),$(this).hide()});var t=$(this).val();""!==t?$("#board_panel").load("lib/php/data/board_load.php",{s:t},function(){$(this).highlight(t)}):$("#board_panel").load("lib/php/data/board_load.php",function(){$(".casenotes_search_clear").hide()})})});